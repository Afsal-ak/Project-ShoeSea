<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
</head>
<body>
    <%- include('../partials/user/header') %>
    <div class="container mt-4">
        <h2>Checkout</h2>

        <!-- Address Selection -->
        <div class="mb-4">
            <h4>Select Delivery Address</h4>
            <form action="/place-order" method="POST">
                <% addresses.forEach(address => { %>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="addressId" value="<%= address._id %>" id="address<%= address._id %>" required>
                        <label class="form-check-label" for="address<%= address._id %>">
                            <strong><%= address.fname %> <%= address.lname %></strong><br>
                            <%= address.housename %>, <%= address.city %>, <%= address.state %>, <%= address.country %> - <%= address.pincode %><br>
                            Phone: <%= address.phone %>
                        </label>
                        <a href="/edit-address/<%= address._id %>" class="btn btn-secondary btn-sm ml-2">Edit</a>
                        <a href="/delete-address/<%= address._id %>" class="btn btn-danger btn-sm ml-2">Delete</a>
                    </div>
                <% }) %>

                <!-- Button to Add a New Address -->
                <a href="/add-address" class="btn btn-primary mb-3">Add New Address</a>

                <!-- Order Summary -->
                <h4>Order Summary</h4>
                <% cart.forEach(item => { %>
                    <div class="mb-2">
                        <p><%= item.product.productName %> - Quantity: <%= item.quantity %></p>
                        <p>Price: <%= item.product.salePrice * item.quantity %></p>
                    </div>
                <% }) %>
                <p><strong>Total Amount: <%= totalAmount %></strong></p>

                <!-- Place Order Button -->
                <button type="submit" class="btn btn-success">Place Order (Cash on Delivery)</button>
            </form>
        </div>
    </div>
    <%- include('../partials/user/footer') %>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
